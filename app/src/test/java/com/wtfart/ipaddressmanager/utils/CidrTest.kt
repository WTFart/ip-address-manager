package com.wtfart.ipaddressmanager.utils

import org.junit.Assert.assertFalse
import org.junit.Assert.assertTrue
import org.junit.Test

/**
 * Created by mickeycj on 11/2/2017 AD.
 */
class CidrTest {

    @Test
    fun `CIDRs with the same notation should be equal`() {
        val cidr1 = Cidr(
                "192.30.12.0/30",
                0b11111111111111111111111111111100,
                0b00000000000000000000000000000011,
                arrayOf(
                        0b11000000000111100000110000000000,
                        0b11000000000111100000110000000001,
                        0b11000000000111100000110000000010,
                        0b11000000000111100000110000000011
                )
        )
        val cidr2 = Cidr(
                "192.30.12.0/30",
                0b11111111111111111111111111111100,
                0b00000000000000000000000000000011,
                arrayOf(
                        0b11000000000111100000110000000000,
                        0b11000000000111100000110000000001,
                        0b11000000000111100000110000000010,
                        0b11000000000111100000110000000011
                )
        )
        assertTrue(cidr1 == cidr2)
    }

    @Test
    fun `CIDRs with the same notation should have the same hashcode`() {
        val cidr1 = Cidr(
                "192.30.12.0/30",
                0b11111111111111111111111111111100,
                0b00000000000000000000000000000011,
                arrayOf(
                        0b11000000000111100000110000000000,
                        0b11000000000111100000110000000001,
                        0b11000000000111100000110000000010,
                        0b11000000000111100000110000000011
                )
        )
        val cidr2 = Cidr(
                "192.30.12.0/30",
                0b11111111111111111111111111111100,
                0b00000000000000000000000000000011,
                arrayOf(
                        0b11000000000111100000110000000000,
                        0b11000000000111100000110000000001,
                        0b11000000000111100000110000000010,
                        0b11000000000111100000110000000011
                )
        )
        assertTrue(cidr1.hashCode() == cidr2.hashCode())
    }

    @Test
    fun `CIDRs with different notations should not be equal`() {
        val cidr1 = Cidr(
                "192.30.12.0/30",
                0b11111111111111111111111111111100,
                0b00000000000000000000000000000011,
                arrayOf(
                        0b11000000000111100000110000000000,
                        0b11000000000111100000110000000001,
                        0b11000000000111100000110000000010,
                        0b11000000000111100000110000000011
                )
        )
        val cidr2 = Cidr(
                "192.30.12.0/31",
                0b11111111111111111111111111111110,
                0b00000000000000000000000000000001,
                arrayOf(
                        0b11000000000111100000110000000000,
                        0b11000000000111100000110000000001
                )
        )
        assertFalse(cidr1 == cidr2)
    }

    @Test
    fun `CIDRs with different notations should have different hashcode`() {
        val cidr1 = Cidr(
                "192.30.12.0/30",
                0b11111111111111111111111111111100,
                0b00000000000000000000000000000011,
                arrayOf(
                        0b11000000000111100000110000000000,
                        0b11000000000111100000110000000001,
                        0b11000000000111100000110000000010,
                        0b11000000000111100000110000000011
                )
        )
        val cidr2 = Cidr(
                "192.30.12.0/31",
                0b11111111111111111111111111111110,
                0b00000000000000000000000000000001,
                arrayOf(
                        0b11000000000111100000110000000000,
                        0b11000000000111100000110000000001
                )
        )
        assertFalse(cidr1.hashCode() == cidr2.hashCode())
    }
}